{"version":3,"sources":["webpack:///E:/code/TeachApp/components/share/share.vue?a2fe","webpack:///E:/code/TeachApp/components/share/share.vue?456d","webpack:///E:/code/TeachApp/components/share/share.vue?5dd7","webpack:///E:/code/TeachApp/components/share/share.vue?5979","uni-app:///components/share/share.vue","webpack:///E:/code/TeachApp/components/share/share.vue?b2d9","webpack:///E:/code/TeachApp/components/share/share.vue?bd78"],"names":["props","shareData","watch","console","data","isShow","title","shareText","href","image","shareType","providerList","created","uni","service","success","name","id","sort","icon","type","fail","content","showCancel","methods","share","e","shareOPtions","provider","scene","complete","path","webUrl","showHandler","compress","img","plus","entry","src","dst","width","height","quality","overwrite","res","downFiled","url","resolve"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkH;AAClH;AACyD;AACL;AACc;;;AAGlE;AAC+L;AAC/L,gBAAgB,wMAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,gFAAM;AACR,EAAE,yFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACfA;AAAA;AAAA;AAAA;AAAiuB,CAAgB,svBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eCmBrvB;EACAA;IACAC;EACA;EACAC;IACAD;MACAE;MACA;MACA;MACA;IACA;EACA;EACAC;IACA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IAAA;IACA;IACAC;MACAC;MAAA;MACAC;QACAZ;QACA;QACA;UACA;YACA;cACAC;gBACAY;gBACAC;gBACAC;gBACAC;cACA;cACAf;gBACAY;gBACAC;gBACAG;gBACAF;gBACAC;cACA;cACA;YACA;cACAf;gBACAY;gBACAC;gBACAC;gBACAC;cACA;cACA;YACA;cACAf;gBACAY;gBACAC;gBACAC;gBACAC;cACA;cACA;YACA;cACA;UAAA;QAEA;QACA;QACAf;UACAY;UACAC;UACAC;UACAC;QACA;QACA;UACA;QACA;MACA;MACAE;QACAlB;QACAU;UACAS;UACAC;QACA;MACA;IACA;EACA;EACAC;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAtB;gBACA;gBACAU;;gBAEA;gBAAA,MACAa;kBAAA;kBAAA;gBAAA;gBACAb;kBACAT;kBACAW;oBACA;oBACAF;oBACA;kBACA;gBACA;gBACA;gBACA;gBAAA;cAAA;gBAAA,MAGA;kBAAA;kBAAA;gBAAA;gBACAA;kBACAS;kBACAC;gBACA;;gBAEA;gBACAV;gBAAA;cAAA;gBAAA,MAIA;kBAAA;kBAAA;gBAAA;gBACAA;kBACAS;kBACAC;gBACA;;gBAEA;gBACAV;gBAAA;cAAA;gBAIAc;kBACAC;kBACAC,oEACA;kBAAA;kBACAT;kBACAL;oBACAZ;oBACAU;sBACAS;sBACAC;oBACA;kBACA;kBACAF;oBACAlB;oBACAU;sBACAS;sBACAC;oBACA;kBACA;kBACAO;oBACA3B;kBACA;gBACA;gBAAA,cAEA;gBAAA,gCACA,yBAMA,yBAGA,yBAGA;gBAAA;cAAA;gBAXAwB;gBACAA;gBACAA;gBACAA;gBAAA;cAAA;gBAGAA;gBAAA;cAAA;gBAGAA;gBAAA;cAAA;gBAGAA,sDACA;gBACAA;gBACAA;kBACAV;kBACAc;kBACAC;kBACAZ;gBACA;gBAAA;cAAA;gBAAA;cAAA;gBAAA,MAMAO;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACA;cAAA;gBAAAA;cAAA;gBAEA;kBAAA;kBACAA;kBACAA;gBACA;;gBAEA;gBACAd;gBACAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IACA;IACAoB;MACA;IACA;IACA;IACAC;MAAA;MACA/B;MACA;MACA;QAAA;UAAA;YAAA;cAAA;gBAAA;kBAAA,KAGAgC;oBAAA;oBAAA;kBAAA;kBAAA;kBAAA,OAEA;gBAAA;kBAAAA;gBAAA;kBAEA;kBACAC;oBACAC;sBAAA;sBACAlC;sBACA;wBAAA;wBACAiC;0BACAE;0BACAC;0BACAC;0BACAC;0BACAC;0BACAC;wBACA;0BACAxC;0BACA;0BACAyC;wBACA;0BACA/B;4BACAS;4BACAC;0BACA;0BACAV;wBACA;sBACA;oBACA;kBACA;oBACAV;oBACAU;sBACAS;sBACAC;oBACA;oBACAV;kBACA;gBAAA;gBAAA;kBAAA;cAAA;YAAA;UAAA;QAAA,CACA;QAAA;UAAA;QAAA;MAAA;IACA;IACAgC;MACA;QACAhC;UACAiC;UACA/B;YACAZ;YACA4C;UACA;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AClRA;AAAA;AAAA;AAAA;AAAo3C,CAAgB,i1CAAG,EAAC,C;;;;;;;;;;;ACAx4C;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/share/share.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./share.vue?vue&type=template&id=18393c44&\"\nvar renderjs\nimport script from \"./share.vue?vue&type=script&lang=js&\"\nexport * from \"./share.vue?vue&type=script&lang=js&\"\nimport style0 from \"./share.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/share/share.vue\"\nexport default component.exports","export * from \"-!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share.vue?vue&type=template&id=18393c44&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function ($event) {\n      $event.stopPropagation()\n      $event.preventDefault()\n      return (function () {})($event)\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view>\r\n\t\t<view v-show=\"isShow\" @click=\"showHandler\" class=\"mask\" @touchmove.stop.prevent=\"()=>{}\">\r\n\t\t</view>\r\n\t\t<view class=\"share-body\" v-show=\"isShow\">\r\n\t\t\t<scroll-view scroll-x class=\"share-scroll noScorll\">\r\n\t\t\t\t<view class=\"share-item\" v-for=\"(item,index) in providerList\" :key=\"index\" @click=\"share(item)\">\r\n\t\t\t\t\t<image :src=\"item.icon\"></image>\r\n\t\t\t\t\t<view>{{item.name}}</view>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t\t<view class=\"share-cancel\" @click=\"showHandler\">\r\n\t\t\t\t取消\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tprops: {\r\n\t\t\tshareData: Object\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tshareData(newVal) {\r\n\t\t\t\tconsole.log(\"监听value\", newVal)\r\n\t\t\t\tthis.image = newVal.mainImage\r\n\t\t\t\tthis.title = newVal.title\r\n\t\t\t\tthis.href = this.$env.HOST_H5 + this.$util.routePath()\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tisShow: false, //是否显示\r\n\t\t\t\ttitle: '在线教育APP实战', // 分享标题\r\n\t\t\t\tshareText: 'uniapp之在线教育APP实战', // 分享内容\r\n\t\t\t\thref: 'https://www.baidu.com', // 用访问链接\r\n\t\t\t\timage: 'https://gd4.alicdn.com/imgextra/i4/3603079088/O1CN01dczOSM2H0LvTowhkl_!!3603079088.png', // 分享图片\r\n\t\t\t\tshareType: 0, // 分享的类型 0 图文，1 文字，2 图片\r\n\t\t\t\tproviderList: [] // 提供商【QQ,微信,微博】\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\t// 获取提供商QQ,微信，微博\r\n\t\t\tuni.getProvider({\r\n\t\t\t\tservice: 'share', // 分享服务\r\n\t\t\t\tsuccess: (e) => {\r\n\t\t\t\t\tconsole.log('success', e);\r\n\t\t\t\t\tlet data = [] // 封装提供商\r\n\t\t\t\t\tfor (let i = 0; i < e.provider.length; i++) {\r\n\t\t\t\t\t\tswitch (e.provider[i]) {\r\n\t\t\t\t\t\t\tcase 'weixin':\r\n\t\t\t\t\t\t\t\tdata.push({\r\n\t\t\t\t\t\t\t\t\tname: '微信好友',\r\n\t\t\t\t\t\t\t\t\tid: 'weixin',\r\n\t\t\t\t\t\t\t\t\tsort: 0,\r\n\t\t\t\t\t\t\t\t\ticon: '/static/share/weixin.png'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tdata.push({\r\n\t\t\t\t\t\t\t\t\tname: '微信朋友圈',\r\n\t\t\t\t\t\t\t\t\tid: 'weixin',\r\n\t\t\t\t\t\t\t\t\ttype: 'WXSenceTimeline',\r\n\t\t\t\t\t\t\t\t\tsort: 1,\r\n\t\t\t\t\t\t\t\t\ticon: '/static/share/pengyouquan.png'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'sinaweibo':\r\n\t\t\t\t\t\t\t\tdata.push({\r\n\t\t\t\t\t\t\t\t\tname: '新浪微博',\r\n\t\t\t\t\t\t\t\t\tid: 'sinaweibo',\r\n\t\t\t\t\t\t\t\t\tsort: 2,\r\n\t\t\t\t\t\t\t\t\ticon: '/static/share/weibo.png'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 'qq':\r\n\t\t\t\t\t\t\t\tdata.push({\r\n\t\t\t\t\t\t\t\t\tname: 'QQ',\r\n\t\t\t\t\t\t\t\t\tid: 'qq',\r\n\t\t\t\t\t\t\t\t\tsort: 3,\r\n\t\t\t\t\t\t\t\t\ticon: '/static/share/qq.png'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 追加复制链接\r\n\t\t\t\t\tdata.push({\r\n\t\t\t\t\t\tname: '复制链接',\r\n\t\t\t\t\t\tid: 'copy',\r\n\t\t\t\t\t\tsort: 4,\r\n\t\t\t\t\t\ticon: '/static/share/link.png'\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.providerList = data.sort((x, y) => {\r\n\t\t\t\t\t\treturn x.sort - y.sort\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tfail: (e) => {\r\n\t\t\t\t\tconsole.log('获取分享通道失败', e);\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: '获取分享通道失败',\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync share(e) {\r\n\t\t\t\tconsole.log('分享通道:' + e.id + '； 分享类型:' + this.shareType);\r\n\t\t\t\t// 加载中\r\n\t\t\t\tuni.showLoading()\r\n\r\n\t\t\t\t// 复制链接\r\n\t\t\t\tif (e.id === 'copy') {\r\n\t\t\t\t\tuni.setClipboardData({\r\n\t\t\t\t\t\tdata: this.href,\r\n\t\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\t\t// 隐藏默认提示\r\n\t\t\t\t\t\t\tuni.hideToast()\r\n\t\t\t\t\t\t\tthis.$util.msg('已复制到剪贴板')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t// 隐藏\r\n\t\t\t\t\tthis.showHandler()\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!this.shareText && (this.shareType === 1 || this.shareType === 0)) {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: '分享内容不能为空',\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// 隐藏加载\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!this.image && (this.shareType === 2 || this.shareType === 0)) {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\tcontent: '分享图片不能为空',\r\n\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t})\r\n\r\n\t\t\t\t\t// 隐藏加载\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet shareOPtions = {\r\n\t\t\t\t\tprovider: e.id,\r\n\t\t\t\t\tscene: e.type && e.type === 'WXSenceTimeline' ? 'WXSenceTimeline' :\r\n\t\t\t\t\t'WXSceneSession', //WXSceneSession”分享到聊天界面，“WXSenceTimeline”分享到朋友圈，“WXSceneFavorite”分享到微信收藏     \r\n\t\t\t\t\ttype: this.shareType,\r\n\t\t\t\t\tsuccess: (e) => {\r\n\t\t\t\t\t\tconsole.log('success', e);\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: '已分享',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: (e) => {\r\n\t\t\t\t\t\tconsole.log('fail', e)\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: e.errMsg,\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: function() {\r\n\t\t\t\t\t\tconsole.log('分享操作结束!')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tswitch (this.shareType) {\r\n\t\t\t\t\tcase 0:\r\n\t\t\t\t\t\tshareOPtions.summary = this.shareText;\r\n\t\t\t\t\t\tshareOPtions.imageUrl = this.image;\r\n\t\t\t\t\t\tshareOPtions.title = this.title;\r\n\t\t\t\t\t\tshareOPtions.href = this.href;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 1:\r\n\t\t\t\t\t\tshareOPtions.summary = this.shareText;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 2:\r\n\t\t\t\t\t\tshareOPtions.imageUrl = this.image;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 5:\r\n\t\t\t\t\t\tshareOPtions.imageUrl = this.image ? this.image :\r\n\t\t\t\t\t\t\t'https://img-cdn-qiniu.dcloud.net.cn/uniapp/app/share-logo@3.png'\r\n\t\t\t\t\t\tshareOPtions.title = '欢迎体验uniapp';\r\n\t\t\t\t\t\tshareOPtions.miniProgram = {\r\n\t\t\t\t\t\t\tid: 'gh_33446d7f7a26',\r\n\t\t\t\t\t\t\tpath: '/pages/tabBar/component/component',\r\n\t\t\t\t\t\t\twebUrl: 'https://uniapp.dcloud.io',\r\n\t\t\t\t\t\t\ttype: 0\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (shareOPtions.type === 0 && plus.os.name === 'iOS') { //如果是图文分享，且是ios平台，则压缩图片 \r\n\t\t\t\t\tshareOPtions.imageUrl = await this.compress();\r\n\t\t\t\t}\r\n\t\t\t\tif (shareOPtions.type === 1 && shareOPtions.provider === 'qq') { //如果是分享文字到qq，则必须加上href和title\r\n\t\t\t\t\tshareOPtions.href = this.href;\r\n\t\t\t\t\tshareOPtions.title = this.title;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// 隐藏加载\r\n\t\t\t\tuni.hideLoading()\r\n\t\t\t\tuni.share(shareOPtions);\r\n\t\t\t},\r\n\t\t\t// 显示\r\n\t\t\tshowHandler() {\r\n\t\t\t\tthis.isShow = !this.isShow\r\n\t\t\t},\r\n\t\t\t//压缩图片 图文分享要求分享图片大小不能超过20Kb \r\n\t\t\tcompress() {\r\n\t\t\t\tconsole.log('开始压缩');\r\n\t\t\t\tlet img = this.image;\r\n\t\t\t\treturn new Promise(async (res) => {\r\n\t\t\t\t\t// var localPath = plus.io.convertAbsoluteFileSystem(img.replace('file://', ''));\r\n\t\t\t\t\t// console.log('after' + localPath);\r\n\t\t\t\t\tif (img.startsWith(\"http\")) {\r\n\t\t\t\t\t\t// 如果是网络路径图片，则下载到本地存储的临时文件\r\n\t\t\t\t\t\timg = await this.downFiled(img)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// 压缩size\r\n\t\t\t\t\tplus.io.resolveLocalFileSystemURL(img, (entry) => {\r\n\t\t\t\t\t\tentry.file((file) => { // 可通过entry对象操作图片\r\n\t\t\t\t\t\t\tconsole.log('getFile:' + JSON.stringify(file));\r\n\t\t\t\t\t\t\tif (file.size > 20480) { // 压缩后size 大于20Kb\r\n\t\t\t\t\t\t\t\tplus.zip.compressImage({\r\n\t\t\t\t\t\t\t\t\tsrc: img,\r\n\t\t\t\t\t\t\t\t\tdst: img.replace('.jpg', '2222.jpg').replace('.JPG', '2222.JPG'),\r\n\t\t\t\t\t\t\t\t\twidth: '10%',\r\n\t\t\t\t\t\t\t\t\theight: '10%',\r\n\t\t\t\t\t\t\t\t\tquality: 1,\r\n\t\t\t\t\t\t\t\t\toverwrite: true\r\n\t\t\t\t\t\t\t\t}, (event) => {\r\n\t\t\t\t\t\t\t\t\tconsole.log('success zip****' + event.size);\r\n\t\t\t\t\t\t\t\t\tlet newImg = img.replace('.jpg', '2222.jpg').replace('.JPG', '2222.JPG');\r\n\t\t\t\t\t\t\t\t\tres(newImg);\r\n\t\t\t\t\t\t\t\t}, function(error) {\r\n\t\t\t\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\t\t\t\tcontent: '分享图片太大,需要请重新选择图片!',\r\n\t\t\t\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}, (e) => {\r\n\t\t\t\t\t\tconsole.log('Resolve file URL failed: ' + e.message);\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: '分享图片太大,需要请重新选择图片!',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tdownFiled(url) {\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tuni.downloadFile({\r\n\t\t\t\t\t\turl,\r\n\t\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t\tconsole.log(\"下载完成\", res.tempFilePath)\r\n\t\t\t\t\t\t\tresolve(res.tempFilePath)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.mask {\r\n\t\tz-index: 99;\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.6);\r\n\t}\r\n\r\n\t.share-body {\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tz-index: 100;\r\n\r\n\t\t.share-cancel {\r\n\t\t\tbackground-color: #FFF;\r\n\t\t\ttext-align: center;\r\n\t\t\twidth: 100%;\r\n\t\t\tpadding: 25rpx 0;\r\n\t\t}\r\n\r\n\t\t.share-scroll {\r\n\t\t\tbackground-color: #f7f7f7;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 200rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\twhite-space: nowrap;\r\n\t\t\tpadding-top: 45rpx;\r\n\r\n\t\t\t.share-item {\r\n\t\t\t\tdisplay: inline-flex;\r\n\t\t\t\tflex-direction: column;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\twidth: 25%;\r\n\t\t\t}\r\n\r\n\t\t\tview {\r\n\t\t\t\tcolor: $mxg-text-color-grey;\r\n\t\t\t\tfont-size: 25rpx;\r\n\t\t\t\tpadding: 10rpx;\r\n\t\t\t}\r\n\r\n\t\t\timage {\r\n\t\t\t\theight: 60rpx;\r\n\t\t\t\twidth: 60rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</style>","import mod from \"-!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HBuilderX.3.8.7.20230703\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./share.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1740795187830\n      var cssReload = require(\"D:/HBuilderX.3.8.7.20230703/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}